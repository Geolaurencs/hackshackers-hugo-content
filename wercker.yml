box: debian
build:
    steps:
        - script:
            name: print commit
            code: echo "Will update submodule to $WERCKER_GIT_COMMIT"
deploy:
    steps:
        - script:
            name: install git
            code: |
                apt-get update
                apt-get install git -y
        - add-ssh-key:
            keyname: HH_CONTENT
            host: github.com
        - add-to-known_hosts:
            hostname: github.com
            fingerprint: 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48
        - script:
            name: Setup main repo
            code: |
                git clone git@github.com:hackshackers/hackshackers-hugo.git hackshackers-hugo
                cd hackshackers-hugo
                git checkout -b auto-update-content
        - script:
            name: Auto-update content submodule
            code: |
                echo "initializing submodules"
                git submodule update --init --recursive
                echo "updating content submodule to remote HEAD"
                git submodule update --remote content
                echo "staging content submodule"
                git add content
                echo "committing content submodule"
                git commit -m "Auto-update content submodule"
                echo "pushing auto-update-content branch to main repo"
                git push origin auto-update-content
